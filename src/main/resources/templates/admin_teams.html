<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
  <meta charset="UTF-8">
  <title>관리자 페이지 - 팀 관리</title>
  <style>
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f4f6f9; margin:0; padding:0; color:#333; }
    header { background: #1f75fe; color: white; padding: 1rem 2rem; display:flex; justify-content: space-between; align-items:center; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    header a { color:white; text-decoration:none; margin-left:1rem; padding: 0.3rem 0.6rem; border-radius: 4px; transition: background 0.3s; }
    header a:hover { background: rgba(255, 255, 255, 0.2); }
    main { padding:2rem; max-width: 1200px; margin: 0 auto; }
    table { width:100%; border-collapse: separate; border-spacing: 0; margin-top:1.5rem; background:white; border-radius:10px; overflow:hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
    th, td { padding:1rem 1.2rem; text-align:left; }
    th { background:#eef2ff; color: #3b82f6; font-weight: 600; border-bottom: 2px solid #d1d5db; }
    tbody tr { border-bottom:1px solid #ebf4ff; transition: background 0.3s; }
    tbody tr:last-child { border-bottom: none; }
    tbody tr:hover { background: #f9fbfc; }
    input[type="text"], input[type="password"], select {
      width: calc(100% - 10px);
      padding:0.6rem;
      border-radius:6px;
      border:1px solid #d1d5db;
      box-sizing: border-box;
      transition: border-color 0.3s, box-shadow 0.3s;
      font-size: 1rem;
    }
    input[readonly] { background-color: #f0f0f0; cursor: not-allowed; }
    input:focus { border-color: #3b82f6; box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2); outline: none; }
    .btn { padding:0.6rem 1rem; border:none; border-radius:6px; cursor:pointer; font-weight: 500; transition: opacity 0.3s, transform 0.2s; min-width: 80px; }
    .btn:hover { opacity:0.9; transform: translateY(-1px); }
    .btn:active { transform: translateY(0); }
    .btn-save { background:#10b981; color:white; }
    .btn-delete { background:#f43f5e; color:white; }
    .btn-cleanup { background:#ff9800; color:white; margin-top: 1rem; } /* ✨ 새로 추가된 스타일 */
    /* 버튼을 감싸는 컨테이너 */
    .action-buttons {
      display: flex;
      gap: 0.5rem;
      align-items: center;
      /* 폼이 <td> 안에서 정상 작동하도록 inline-flex 사용 */
      display: inline-flex;
    }
    /* 폼의 마진 제거 */
    .action-buttons form { margin: 0; }
    .top-actions { text-align: right; margin-bottom: 1.5rem; } /* ✨ 새로 추가된 컨테이너 */
  </style>
</head>
<body>
<header>
  <h1>관리자 페이지 - 팀 관리</h1>
  <nav>
    <a th:href="@{/main}">메인</a>
    <a th:href="@{/admin/users}">사용자 관리</a>
  </nav>
</header>
<main>
  <div class="top-actions">
    <form th:action="@{/admin/teams/cleanup}" method="post" onsubmit="return confirm('경고: 관리자 정보(managerName)가 \"NULL\"인 모든 팀을 영구적으로 삭제하시겠습니까?');">
    <button type="submit" class="btn btn-cleanup">🗑️ 고아 팀 일괄 정리 (NULL)</button>
    </form>
  </div>
  <table>
    <thead>
    <tr>
      <th style="width: 10%;">ID</th>
      <th style="width: 25%;">팀 이름</th>
      <th style="width: 25%;">설명</th>
      <th style="width: 20%;">비밀번호</th>
      <th style="width: 10%;">팀장</th>
      <th style="width: 10%;">작업</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="team : ${teams}">
      <form th:action="@{/admin/teams/update}" method="post">
        <td>
          <input type="text" th:value="${team.id}" readonly />
          <input type="hidden" th:name="teamId" th:value="${team.id}" />
        </td>

        <td>
          <input type="text" th:name="name" th:value="${team.name}" />
        </td>

        <td>
          <input type="text" th:name="description" th:value="${team.description}" />
        </td>

        <td>
          <input type="password" th:name="password" placeholder="변경시 입력" />
        </td>

        <td th:text="${team.managerName}"
            th:style="${team.managerName == 'NULL' ? 'color: #f43f5e; font-weight: bold;' : ''}">
          홍길동
        </td>

        <td>
          <div class="action-buttons">
            <button type="submit" class="btn btn-save">💾 저장</button>
      </form>
      <form th:action="@{/admin/teams/delete}" method="post">
        <input type="hidden" th:name="teamId" th:value="${team.id}" />
        <button type="submit" class="btn btn-delete" onclick="return confirm('정말 삭제하시겠습니까?');">🗑 삭제</button>
      </form>
      </div>
      </td>
    </tr>
    </tbody>
  </table>
</main>
</body>
</html>