<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
  <meta charset="UTF-8">
  <title>관리자 페이지 - 사용자 관리</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; background: #f7f8fa; margin:0; padding:0; color:#333; }
    header { background: #3b82f6; color: white; padding: 1rem 2rem; display:flex; justify-content: space-between; align-items:center; }
    main { padding:2rem; }
    table { width:100%; border-collapse: collapse; margin-top:1rem; background:white; border-radius:8px; overflow:hidden; }
    th, td { padding:0.8rem 1rem; text-align:left; border-bottom:1px solid #ddd; }
    th { background:#e0e7ff; }
    input, select { width:100%; padding:0.4rem; border-radius:4px; border:1px solid #ccc; box-sizing: border-box; }
    .btn { padding:0.4rem 0.8rem; border:none; border-radius:4px; cursor:pointer; margin-right:0.2rem; }
    .btn-save { background:#3b82f6; color:white; }
    .btn-delete { background:#ef4444; color:white; }
    .btn:hover { opacity:0.9; }
    form { margin:0; display:flex; gap:0.5rem; align-items:center; }
    td > form { display:flex; gap:0.5rem; width:100%; }
  </style>
</head>
<body>
<header>
  <h1>관리자 페이지 - 사용자 관리</h1>
  <nav>
    <a th:href="@{/main}" style="color:white; text-decoration:none;">메인</a>
  </nav>
</header>
<main>
  <table>
    <thead>
    <tr>
      <th>이름</th>
      <th>사용자명</th>
      <th>비밀번호</th>
      <th>역할</th>
      <th>작업</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="user : ${users}">
      <form th:action="@{/admin/users/update}" method="post">
        <td>
          <input type="hidden" th:name="userId" th:value="${user.id}" />
          <input type="text" th:name="name" th:value="${user.name}" />
        </td>
        <td>
          <input type="text" th:name="username" th:value="${user.username}" />
        </td>
        <td>
          <input type="text" th:name="password" placeholder="새 비밀번호 입력"/>
        </td>
        <td>
          <select th:name="role">
            <option th:value="ROLE_USER" th:selected="${user.role.toString()=='USER' or user.role.toString()=='ROLE_USER'}">USER</option>
            <option th:value="ROLE_ADMIN" th:selected="${user.role.toString()=='ADMIN' or user.role.toString()=='ROLE_ADMIN'}">ADMIN</option>
          </select>
        </td>
        <td>
          <button type="submit" class="btn btn-save">💾 저장</button>
      </form>
      <form th:action="@{/admin/users/delete}" method="post" style="display:inline;">
        <input type="hidden" th:name="userId" th:value="${user.id}" />
        <button type="submit" class="btn btn-delete" onclick="return confirm('정말 삭제하시겠습니까?');">🗑 삭제</button>
      </form>
      </td>
    </tr>
    </tbody>
  </table>
</main>
</body>
</html>
