<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>과제 제출</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; background: #f7f8fa; margin: 0; padding: 0; color: #333; }
    header { background: #3b82f6; color: white; padding: 1rem 2rem; display: flex; justify-content: space-between; align-items: center; }
    header h1 { margin: 0; }
    header nav a { color: white; margin-left: 1rem; text-decoration: none; }
    main { padding: 2rem; }
    form { background: white; padding: 2rem; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); max-width: 600px; margin: auto; }
    label { display: block; margin-top: 1rem; font-weight: bold; }
    input[type="file"] { width: 100%; padding: 0.5rem; margin-top: 0.5rem; border: 1px solid #ccc; border-radius: 6px; }
    button { background: #3b82f6; color: white; border: none; padding: 0.6rem 1.2rem; border-radius: 6px; font-size: 1rem; margin-top: 1rem; cursor: pointer; }
    button:hover { background: #2563eb; }
    .assignment-info { margin-bottom: 2rem; border-left: 4px solid #3b82f6; padding-left: 1rem; }
    .file-link { margin-top: 1rem; padding: 0.8rem; background: #f1f5f9; border-radius: 6px; }
    .file-link a { color: #3b82f6; text-decoration: none; font-weight: bold; }
    .file-link a:hover { text-decoration: underline; }
    .message { padding: 10px; margin-bottom: 1rem; border-radius: 4px; background-color: #d1e7dd; color: #0f5132; border: 1px solid #badbcc; }
    .error { padding: 10px; margin-bottom: 1rem; border-radius: 4px; background-color: #f8d7da; color: #842029; border: 1px solid #f5c2c7; }
  </style>
</head>
<body>
<header>
  <h1>과제 제출</h1>
  <nav>
    <span th:text="${username}">사용자</span>
    <a th:href="@{/logout}">로그아웃</a>
    <a th:href="@{'/projects/' + ${teamId}}">과제 목록</a>
  </nav>
</header>

<main>
  <div th:if="${message}" class="message" th:text="${message}"></div>
  <div th:if="${error}" class="error" th:text="${error}"></div>

  <div class="assignment-info">
    <h2 th:text="${assignment.name}"></h2>
    <p th:text="${assignment.description}"></p>
    <p><strong>마감일:</strong>
      <span th:text="${#temporals.format(assignment.deadline, 'yyyy-MM-dd HH:mm')}"></span>
    </p>
    <p th:if="${submission != null}">
      <strong>최종 제출 일시:</strong>
      <span th:text="${#temporals.format(submission.submittedAt, 'yyyy-MM-dd HH:mm:ss')}"></span>
    </p>
  </div>

  <form th:action="@{/assignments/{assignmentId}/submit(assignmentId=${assignment.id})}"
        method="post"
        enctype="multipart/form-data">

    <label for="file">새 파일 선택</label>
    <input type="file" id="file" name="file" required />

    <div th:if="${submission != null}">
      <div class="file-link">
        제출된 파일:
        <a th:href="@{'/assignments/download/' + ${submission.id}}"
           th:text="${submission.fileName}">다운로드</a>
      </div>
      <button type="submit">수정하기</button>
    </div>

    <div th:unless="${submission != null}">
      <button type="submit">제출하기</button>
    </div>
  </form>
</main>
</body>
</html>